<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Daftar Pasien Klinik Sehat</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #f3f6f8;
      margin: 0;
      padding: 20px;
      color: #222;
    }
    h1 {
      text-align: center;
      color: #4CAF50;
      margin-bottom: 50px;
      font-weight: 700;
      font-size: 2.5rem;
    }

    form {
      max-width: 600px;
      margin: 0 auto 40px auto;
      background: #fff;
      padding: 20px 30px;
      border-radius: 8px;
      box-shadow: 0 6px 15px rgb(0 0 0 / 0.1);
    }
    form label {
      display: block;
      font-weight: 600;
      margin-bottom: 6px;
      margin-top: 15px;
      color: #333;
    }
    form input[type="text"],
    form input[type="date"] {
      width: 100%;
      padding: 10px 12px;
      border: 1.5px solid #ccc;
      border-radius: 5px;
      font-size: 1rem;
      transition: border-color 0.3s ease;
    }
    form input[type="text"]:focus,
    form input[type="date"]:focus {
      border-color: #4caf50;
      outline: none;
    }
    .gender-options {
      display: flex;
      gap: 20px;
      margin-top: 6px;
    }
    .gender-options label {
      font-weight: 400;
      cursor: pointer;
      color: #555;
    }
    button {
      margin-top: 25px;
      background-color: #4caf50;
      color: white;
      border: none;
      padding: 12px 25px;
      font-size: 1.1rem;
      font-weight: 700;
      border-radius: 6px;
      cursor: pointer;
      width: 100%;
      transition: background-color 0.3s ease;
    }
    button:hover {
      background-color: #45a047;
    }
    .error-message {
      color: #d93025;
      font-size: 0.9rem;
      margin-top: 4px;
      display: none;
    }

    table {
      width: 90%;
      max-width: 900px;
      margin: 0 auto;
      border-collapse: collapse;
      box-shadow: 0 4px 12px rgb(0 0 0 / 0.1);
      border-radius: 10px;
      overflow: hidden;
      background: white;
    }
    thead tr {
      background-color: #4caf50;
      color: white;
      text-align: left;
    }
    thead th {
      padding: 15px 20px;
    }
    tbody tr {
      border-bottom: 1px solid #ddd;
      transition: background-color 0.3s ease;
      cursor: default;
    }
    tbody tr:hover {
      background-color: #e6f4ea;
    }
    tbody td {
      padding: 14px 20px;
      vertical-align: middle;
      color: #333;
    }
    tbody td.action-cell {
      text-align: center;
      white-space: nowrap;
    }
    .btn-edit, .btn-delete {
      border: none;
      background: none;
      cursor: pointer;
      font-weight: 700;
      margin-left: 12px;
      font-size: 0.95rem;
      padding: 3px 8px;
      border-radius: 5px;
      transition: background-color 0.25s ease;
    }
    .btn-edit {
      color: #1565c0;
    }
    .btn-edit:hover {
      background-color: #d0e3fb;
    }
    .btn-delete {
      color: #d93025;
    }
    .btn-delete:hover {
      background-color: #f9d6d5;
    }
  </style>
</head>
<body>
  <h1>Daftar Pasien Klinik Sehat</h1>

  <form id="patientForm" novalidate>
    <label for="fullName">Nama Lengkap</label>
    <input type="text" id="fullName" name="fullName" autocomplete="off" required />
    <div id="nameError" class="error-message">Nama Lengkap wajib diisi.</div>

    <label for="medicalRecord">No. Rekam Medis</label>
    <input type="text" id="medicalRecord" name="medicalRecord" autocomplete="off" required />
    <div id="recordError" class="error-message">No. Rekam Medis wajib diisi.</div>

    <label for="birthDate">Tanggal Lahir</label>
    <input type="date" id="birthDate" name="birthDate" required />
    <div id="dateError" class="error-message">Tanggal Lahir wajib diisi.</div>

    <label>Jenis Kelamin</label>
    <div class="gender-options">
      <label><input type="radio" name="gender" value="Laki-laki" required /> Laki-laki</label>
      <label><input type="radio" name="gender" value="Perempuan" /> Perempuan</label>
    </div>
    <div id="genderError" class="error-message">Pilih jenis kelamin.</div>

    <button type="submit">Simpan</button>
  </form>

  <table id="patientsTable" aria-label="Daftar pasien klinik sehat">
    <thead>
      <tr>
        <th>No</th>
        <th>Nama Pasien</th>
        <th>No. Rekam Medis</th>
        <th>Tanggal Lahir</th>
        <th>Aksi</th>
      </tr>
    </thead>
    <tbody>
      <!-- Data pasien akan muncul di sini -->
    </tbody>
  </table>

  <script>
    (function() {
      const patientForm = document.getElementById('patientForm');
      const tableBody = document.querySelector('#patientsTable tbody');

      // Errors
      const errors = {
        fullName: document.getElementById('nameError'),
        medicalRecord: document.getElementById('recordError'),
        birthDate: document.getElementById('dateError'),
        gender: document.getElementById('genderError'),
      };

      let patients = [];
      let editIndex = null;

      function clearErrors() {
        Object.values(errors).forEach(err => err.style.display = 'none');
      }

      // Render patients list into table
      function renderTable() {
        tableBody.innerHTML = '';
        patients.forEach((patient, idx) => {
          const row = document.createElement('tr');

          // No
          const noCell = document.createElement('td');
          noCell.textContent = idx + 1;
          row.appendChild(noCell);

          // Nama Pasien
          const nameCell = document.createElement('td');
          nameCell.textContent = patient.fullName;
          row.appendChild(nameCell);

          // No. Rekam Medis
          const recordCell = document.createElement('td');
          recordCell.textContent = patient.medicalRecord;
          row.appendChild(recordCell);

          // Tanggal Lahir - format dd/mm/yyyy
          const dateCell = document.createElement('td');
          if(patient.birthDate){
            const d = new Date(patient.birthDate);
            const day = d.getDate().toString().padStart(2,'0');
            const month = (d.getMonth() + 1).toString().padStart(2,'0');
            const year = d.getFullYear();
            dateCell.textContent = `${day}/${month}/${year}`;
          } else {
            dateCell.textContent = '';
          }
          row.appendChild(dateCell);

          // Aksi - Edit and Delete buttons
          const actionsCell = document.createElement('td');
          actionsCell.classList.add('action-cell');

          const editBtn = document.createElement('button');
          editBtn.textContent = 'Edit';
          editBtn.classList.add('btn-edit');
          editBtn.setAttribute('aria-label', `Edit pasien ${patient.fullName}`);
          editBtn.addEventListener('click', () => editPatient(idx));

          const delBtn = document.createElement('button');
          delBtn.textContent = 'Ã—';
          delBtn.title = 'Hapus';
          delBtn.classList.add('btn-delete');
          delBtn.setAttribute('aria-label', `Hapus pasien ${patient.fullName}`);
          delBtn.addEventListener('click', () => deletePatient(idx));

          actionsCell.appendChild(editBtn);
          actionsCell.appendChild(delBtn);
          row.appendChild(actionsCell);

          tableBody.appendChild(row);
        });
      }

      // Clear form fields
      function clearForm() {
        patientForm.reset();
        clearErrors();
        editIndex = null;
      }

      // Fill form for editing
      function editPatient(index) {
        const p = patients[index];
        document.getElementById('fullName').value = p.fullName;
        document.getElementById('medicalRecord').value = p.medicalRecord;
        document.getElementById('birthDate').value = p.birthDate;
        const genderRadios = patientForm.elements['gender'];
        for(let radio of genderRadios) {
          radio.checked = radio.value === p.gender;
        }
        editIndex = index;
      }

      // Delete patient
      function deletePatient(index) {
        if(confirm(`Apakah Anda yakin ingin menghapus data pasien "${patients[index].fullName}"?`)) {
          patients.splice(index, 1);
          renderTable();
          if(editIndex === index) {
            clearForm();
          }
        }
      }

      // Validate form, returns boolean
      function validateForm() {
        clearErrors();
        let valid = true;

        const fullName = patientForm.fullName.value.trim();
        const medicalRecord = patientForm.medicalRecord.value.trim();
        const birthDate = patientForm.birthDate.value;
        const genderRadios = patientForm.elements['gender'];
        let genderSelected = false;
        for(let radio of genderRadios) {
          if(radio.checked) {
            genderSelected = true;
            break;
          }
        }

        if(!fullName) {
          errors.fullName.style.display = 'block';
          valid = false;
        }
        if(!medicalRecord) {
          errors.medicalRecord.style.display = 'block';
          valid = false;
        }
        if(!birthDate) {
          errors.birthDate.style.display = 'block';
          valid = false;
        }
        if(!genderSelected) {
          errors.gender.style.display = 'block';
          valid = false;
        }

        return valid;
      }

      patientForm.addEventListener('submit', function(e) {
        e.preventDefault();

        if(!validateForm()) return;

        // Get values
        const newPatient = {
          fullName: patientForm.fullName.value.trim(),
          medicalRecord: patientForm.medicalRecord.value.trim(),
          birthDate: patientForm.birthDate.value,
          gender: [...patientForm.elements['gender']].find(r => r.checked).value,
        };

        if(editIndex === null) {
          // Add new
          patients.push(newPatient);
        } else {
          // Update existing
          patients[editIndex] = newPatient;
          editIndex = null;
        }
        renderTable();
        clearForm();
      });

      // Initial render with example data
      patients = [
        { fullName: "Budi Santoso", medicalRecord: "RM-001", birthDate: "1980-02-05", gender: "Laki-laki" },
        { fullName: "Siti Aminah", medicalRecord: "RM-002", birthDate: "1975-08-12", gender: "Perempuan" }
      ];
      renderTable();

    })();
  </script>
</body>
</html>

